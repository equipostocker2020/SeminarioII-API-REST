/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 13.5 		*/
/*  Created On : 24-sep.-2020 22:00:41 				*/
/*  DBMS       : MySql 						*/
/* ---------------------------------------------------- */

SET FOREIGN_KEY_CHECKS=0 
;

/* Drop Tables */

DROP TABLE IF EXISTS `ALUMNOS` CASCADE
;

DROP TABLE IF EXISTS `AULA` CASCADE
;

DROP TABLE IF EXISTS `AULAS_MATERIA` CASCADE
;

DROP TABLE IF EXISTS `DOCENTE` CASCADE
;

DROP TABLE IF EXISTS `EVALUACION` CASCADE
;

DROP TABLE IF EXISTS `INSCRIPCION` CASCADE
;

DROP TABLE IF EXISTS `INSTANCIA_EVALUACION` CASCADE
;

DROP TABLE IF EXISTS `MATERIA` CASCADE
;

DROP TABLE IF EXISTS `NOTA_ALUMNO` CASCADE
;

DROP TABLE IF EXISTS `USUARIO` CASCADE
;

/* Create Tables */

CREATE TABLE `ALUMNOS`
(
	`ID_USUARIO` INT(11) NOT NULL,
	CONSTRAINT `PK_ALUMNOS` PRIMARY KEY (`ID_USUARIO` ASC)
)

;

CREATE TABLE `AULA`
(
	`ID_AULA` INT(11) NOT NULL AUTO_INCREMENT,
	CONSTRAINT `PK_AULA` PRIMARY KEY (`ID_AULA` ASC)
)

;

CREATE TABLE `AULAS_MATERIAS`
(
	`ID_AULA` INT(11) NOT NULL,
	`ID_MATERIA` INT(11) NOT NULL,
	`ANHO` VARCHAR(50) NOT NULL,
	`ID_REL` INT(11) NOT NULL AUTO_INCREMENT,
	`ID_INSTANCIA` INT(11) NULL,
	`ID_DOCENTE` INT(11) NULL,
	CONSTRAINT `PK_AULAS_MATERIAS` PRIMARY KEY (`ID_REL` ASC)
)

;

CREATE TABLE `DOCENTE`
(
	`ID_USUARIO` INT(11) NOT NULL,
	CONSTRAINT `PK_DOCENTE` PRIMARY KEY (`ID_USUARIO` ASC)
)

;

CREATE TABLE `EVALUACION`
(
	`ID_EVALUACION` INT(11) NOT NULL AUTO_INCREMENT,
	`ID_MATERIA` INT(11) NULL,
	CONSTRAINT `PK_EVALUACION` PRIMARY KEY (`ID_EVALUACION` ASC)
)

;

CREATE TABLE `INSCRIPCION`
(
	`ID_INSCRIPCION` INT(11) NOT NULL AUTO_INCREMENT,
	`ID_ALUMNO` INT(11) NULL,
	`ID_AULA_MATERIA` INT(11) NULL,
	CONSTRAINT `PK_INSCRIPCION` PRIMARY KEY (`ID_INSCRIPCION` ASC)
)

;

CREATE TABLE `INSTANCIA_EVALUACION`
(
	`ID_INSTANCIA` INT(11) NOT NULL AUTO_INCREMENT,
	CONSTRAINT `PK_INSTANCIA_EVALUACION` PRIMARY KEY (`ID_INSTANCIA` ASC)
)

;

CREATE TABLE `MATERIA`
(
	`ID_MATERIA` INT(11) NOT NULL AUTO_INCREMENT,
	CONSTRAINT `PK_MATERIA` PRIMARY KEY (`ID_MATERIA` ASC)
)

;

CREATE TABLE `NOTA_ALUMNO`
(
	`ID_NOTA` INT(11) NOT NULL AUTO_INCREMENT,
	`ID_INSCRIPCION` INT(11) NULL,
	`ID_INSTANCIA` INT(11) NULL,
	`NOTA` VARCHAR(50) NULL,
	CONSTRAINT `PK_NOTA_ALUMNO` PRIMARY KEY (`ID_NOTA` ASC)
)

;

CREATE TABLE `USUARIO`
(
	`ID_USUARIO` INT(11) NOT NULL AUTO_INCREMENT,
	`DETERMINANDO` VARCHAR(50) NULL,
	CONSTRAINT `PK_USUARIO` PRIMARY KEY (`ID_USUARIO` ASC)
)

;

/* Create Primary Keys, Indexes, Uniques, Checks */

ALTER TABLE `ALUMNOS` 
 ADD INDEX `IXFK_ALUMNOS_USUARIO` (`ID_USUARIO` ASC)
;

ALTER TABLE `AULAS_MATERIAS` 
 ADD CONSTRAINT `unique` UNIQUE (`ANHO` ASC, `ID_MATERIA` ASC, `ID_AULA` ASC)
;

ALTER TABLE `AULAS_MATERIAS` 
 ADD INDEX `IXFK_AULAS_MATERIAS_AULA` (`ID_AULA` ASC)
;

ALTER TABLE `AULAS_MATERIAS` 
 ADD INDEX `IXFK_AULAS_MATERIAS_DOCENTE` (`ID_DOCENTE` ASC)
;

ALTER TABLE `AULAS_MATERIAS` 
 ADD INDEX `IXFK_AULAS_MATERIAS_INSTANCIA_EVALUACION` (`ID_INSTANCIA` ASC)
;

ALTER TABLE `AULAS_MATERIAS` 
 ADD INDEX `IXFK_AULAS_MATERIAS_MATERIA` (`ID_MATERIA` ASC)
;

ALTER TABLE `DOCENTE` 
 ADD INDEX `IXFK_DOCENTE_USUARIO` (`ID_USUARIO` ASC)
;

ALTER TABLE `EVALUACION` 
 ADD INDEX `IXFK_EVALUACION_MATERIA` (`ID_MATERIA` ASC)
;

ALTER TABLE `INSCRIPCION` 
 ADD CONSTRAINT `Unique` UNIQUE (`ID_ALUMNO` ASC, `ID_AULA_MATERIA` ASC)
;

ALTER TABLE `INSCRIPCION` 
 ADD INDEX `IXFK_INSCRIPCION_ALUMNOS` (`ID_ALUMNO` ASC)
;

ALTER TABLE `INSCRIPCION` 
 ADD INDEX `IXFK_INSCRIPCION_AULAS_MATERIAS` (`ID_AULA_MATERIA` ASC)
;

ALTER TABLE `NOTA_ALUMNO` 
 ADD CONSTRAINT `UNICA` UNIQUE (`ID_INSCRIPCION` ASC, `ID_INSTANCIA` ASC)
;

ALTER TABLE `NOTA_ALUMNO` 
 ADD INDEX `IXFK_NOTA_ALUMNO_INSCRIPCION` (`ID_INSCRIPCION` ASC)
;

ALTER TABLE `NOTA_ALUMNO` 
 ADD INDEX `IXFK_NOTA_ALUMNO_INSCRIPCION_02` (`ID_INSCRIPCION` ASC)
;

ALTER TABLE `NOTA_ALUMNO` 
 ADD INDEX `IXFK_NOTA_ALUMNO_INSTANCIA_EVALUACION` (`ID_INSTANCIA` ASC)
;

/* Create Foreign Key Constraints */

ALTER TABLE `ALUMNOS` 
 ADD CONSTRAINT `FK_ALUMNOS_USUARIO`
	FOREIGN KEY (`ID_USUARIO`) REFERENCES `USUARIO` (`ID_USUARIO`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `AULAS_MATERIAS` 
 ADD CONSTRAINT `FK_AULAS_MATERIAS_AULA`
	FOREIGN KEY (`ID_AULA`) REFERENCES `AULA` (`ID_AULA`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `AULAS_MATERIAS` 
 ADD CONSTRAINT `FK_AULAS_MATERIAS_DOCENTE`
	FOREIGN KEY (`ID_DOCENTE`) REFERENCES `DOCENTE` (`ID_USUARIO`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `AULAS_MATERIAS` 
 ADD CONSTRAINT `FK_AULAS_MATERIA_INSTANCIA_EVALUACION`
	FOREIGN KEY (`ID_INSTANCIA`) REFERENCES `INSTANCIA_EVALUACION` (`ID_INSTANCIA`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `AULAS_MATERIAS` 
 ADD CONSTRAINT `FK_AULAS_MATERIAS_MATERIA`
	FOREIGN KEY (`ID_MATERIA`) REFERENCES `MATERIA` (`ID_MATERIA`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `DOCENTE` 
 ADD CONSTRAINT `FK_DOCENTE_USUARIO`
	FOREIGN KEY (`ID_USUARIO`) REFERENCES `USUARIO` (`ID_USUARIO`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `EVALUACION` 
 ADD CONSTRAINT `FK_EVALUACION_MATERIA`
	FOREIGN KEY (`ID_MATERIA`) REFERENCES `MATERIA` (`ID_MATERIA`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `INSCRIPCION` 
 ADD CONSTRAINT `FK_INSCRIPCION_ALUMNOS`
	FOREIGN KEY (`ID_ALUMNO`) REFERENCES `ALUMNOS` (`ID_USUARIO`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `INSCRIPCION` 
 ADD CONSTRAINT `FK_INSCRIPCION_AULAS_MATERIAS`
	FOREIGN KEY (`ID_AULA_MATERIA`) REFERENCES `AULAS_MATERIAS` (`ID_REL`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `NOTA_ALUMNO` 
 ADD CONSTRAINT `FK_NOTA_ALUMNO_INSCRIPCION`
	FOREIGN KEY (`ID_INSCRIPCION`) REFERENCES  `INSCRIPCION` (`ID_INSCRIPCION`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `NOTA_ALUMNO` 
 ADD CONSTRAINT `FK_NOTA_ALUMNO_INSCRIPCION_02`
	FOREIGN KEY (`ID_INSCRIPCION`) REFERENCES `INSCRIPCION` (`ID_INSCRIPCION`) ON DELETE Restrict ON UPDATE Restrict
;

ALTER TABLE `NOTA_ALUMNO` 
 ADD CONSTRAINT `FK_NOTA_ALUMNO_INSTANCIA_EVALUACION`
	FOREIGN KEY (`ID_INSTANCIA`) REFERENCES `INSTANCIA_EVALUACION` (`ID_INSTANCIA`) ON DELETE Restrict ON UPDATE Restrict
;

SET FOREIGN_KEY_CHECKS=1 
;